<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no, orientation=portrait">
    <title>Viking Settlement Tycoon - Mobile</title>
    <link href="https://fonts.googleapis.com/css2?family=Space+Mono:wght@400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="android-styles.css">
    <script>
        // Force portrait orientation
        if (screen.orientation && screen.orientation.lock) {
            screen.orientation.lock('portrait').catch(() => {});
        }
        
        // Prevent zoom on double tap
        document.addEventListener('touchstart', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });
        
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = (new Date()).getTime();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, false);
    </script>
</head>
<body>
    <div id="gameContainer">
        <!-- Mobile Top Status Bar -->
        <div id="mobileTopBar">
            <div class="status-section">
                <h1 class="mobile-title">Viking Tycoon</h1>
                <div class="mobile-population">
                    <span class="mobile-icon">👥</span>
                    <span id="mobilePop">5</span>
                </div>
            </div>
        </div>

        <!-- Mobile Resources Panel -->
        <div id="mobileResourcesPanel">
            <div class="mobile-resource">
                <span class="mobile-resource-icon">🌾</span>
                <div class="mobile-resource-info">
                    <span id="mobileFood">100</span>
                    <span class="mobile-rate">(0/s)</span>
                </div>
            </div>
            <div class="mobile-resource">
                <span class="mobile-resource-icon">🪵</span>
                <div class="mobile-resource-info">
                    <span id="mobileWood">50</span>
                    <span class="mobile-rate">(0/s)</span>
                </div>
            </div>
            <div class="mobile-resource">
                <span class="mobile-resource-icon">⚒️</span>
                <div class="mobile-resource-info">
                    <span id="mobileIron">25</span>
                    <span class="mobile-rate">(0/s)</span>
                </div>
            </div>
            <div class="mobile-resource">
                <span class="mobile-resource-icon">🏺</span>
                <div class="mobile-resource-info">
                    <span id="mobileGold">10</span>
                    <span class="mobile-rate">(0/s)</span>
                </div>
            </div>
        </div>

        <!-- Mobile Game Canvas -->
        <div id="mobileGameArea">
            <canvas id="gameCanvas"></canvas>
            
            <!-- Mobile Touch Controls Overlay -->
            <div id="touchControlsOverlay">
                <div class="touch-hint">Drag to explore • Long press to scout • Pinch to zoom • Double tap to zoom</div>
            </div>
        </div>

        <!-- Mobile Bottom Panel -->
        <div id="mobileBottomPanel">
            <!-- Tab Navigation -->
            <div id="mobileTabNav">
                <button class="mobile-tab active" data-tab="buildings">🏗️ Build</button>
                <button class="mobile-tab" data-tab="stats">📊 Stats</button>
                <button class="mobile-tab" data-tab="actions">⚙️ Actions</button>
            </div>

            <!-- Buildings Tab -->
            <div id="mobileBuildingsTab" class="mobile-tab-content active">
                <div class="mobile-building-grid">
                    <div class="mobile-building-card" data-building="longhouse">
                        <div class="mobile-building-icon">🏘️</div>
                        <div class="mobile-building-name">Longhouse</div>
                        <div class="mobile-building-cost">🪵20 🌾10</div>
                    </div>
                    <div class="mobile-building-card" data-building="farm">
                        <div class="mobile-building-icon">🌾</div>
                        <div class="mobile-building-name">Farm</div>
                        <div class="mobile-building-cost">🪵15</div>
                    </div>
                    <div class="mobile-building-card" data-building="lumbermill">
                        <div class="mobile-building-icon">🪓</div>
                        <div class="mobile-building-name">Mill</div>
                        <div class="mobile-building-cost">🪵25 ⚒️5</div>
                    </div>
                    <div class="mobile-building-card" data-building="blacksmith">
                        <div class="mobile-building-icon">⚒️</div>
                        <div class="mobile-building-name">Smith</div>
                        <div class="mobile-building-cost">🪵30 ⚒️10</div>
                    </div>
                    <div class="mobile-building-card" data-building="tradingpost">
                        <div class="mobile-building-icon">⛵</div>
                        <div class="mobile-building-name">Trade</div>
                        <div class="mobile-building-cost">🪵40 🏺5</div>
                    </div>
                    <div class="mobile-building-card" data-building="temple">
                        <div class="mobile-building-icon">⚡</div>
                        <div class="mobile-building-name">Temple</div>
                        <div class="mobile-building-cost">🪵50 ⚒️20</div>
                    </div>
                </div>
            </div>

            <!-- Stats Tab -->
            <div id="mobileStatsTab" class="mobile-tab-content">
                <div class="mobile-stats-grid">
                    <div class="mobile-stat-item">
                        <span class="mobile-stat-label">😊 Happiness</span>
                        <div class="mobile-stat-bar">
                            <div class="mobile-stat-fill" id="mobileHappinessBar" style="width: 75%"></div>
                        </div>
                    </div>
                    <div class="mobile-stat-item">
                        <span class="mobile-stat-label">🛡️ Defense</span>
                        <div class="mobile-stat-bar">
                            <div class="mobile-stat-fill" id="mobileDefenseBar" style="width: 40%"></div>
                        </div>
                    </div>
                    <div class="mobile-stat-item">
                        <span class="mobile-stat-label">💰 Prosperity</span>
                        <div class="mobile-stat-bar">
                            <div class="mobile-stat-fill" id="mobileProsperityBar" style="width: 60%"></div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Actions Tab -->
            <div id="mobileActionsTab" class="mobile-tab-content">
                <div class="mobile-actions-grid">
                    <button id="mobileNewTerritoryBtn" class="mobile-action-btn">
                        🗺️ New Territory
                    </button>
                    <button id="mobileSaveBtn" class="mobile-action-btn">
                        💾 Save Game
                    </button>
                    <button id="mobileInfoBtn" class="mobile-action-btn">
                        ℹ️ Device Info
                    </button>
                    <button id="mobileHelpBtn" class="mobile-action-btn">
                        ❓ Help
                    </button>
                </div>
            </div>
        </div>

        <!-- Mobile Notifications -->
        <div id="mobileNotifications"></div>

        <!-- Mobile Device Info Modal -->
        <div id="mobileDeviceModal" class="mobile-modal">
            <div class="mobile-modal-content">
                <div class="mobile-modal-header">
                    <h3>Device Information</h3>
                    <button class="mobile-modal-close">&times;</button>
                </div>
                <div class="mobile-modal-body">
                    <div class="device-info-item">
                        <span class="device-label">Game Version:</span>
                        <span id="gameVersion">1.0.0</span>
                    </div>
                    <div class="device-info-item">
                        <span class="device-label">Screen Size:</span>
                        <span id="screenSize">-</span>
                    </div>
                    <div class="device-info-item">
                        <span class="device-label">Platform:</span>
                        <span id="platformInfo">-</span>
                    </div>
                    <div class="device-info-item">
                        <span class="device-label">Browser:</span>
                        <span id="browserInfo">-</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Mobile Help Modal -->
        <div id="mobileHelpModal" class="mobile-modal">
            <div class="mobile-modal-content">
                <div class="mobile-modal-header">
                    <h3>How to Play</h3>
                    <button class="mobile-modal-close">&times;</button>
                </div>
                <div class="mobile-modal-body">
                    <div class="help-section">
                        <h4>🏗️ Building</h4>
                        <p>Tap Build tab, select a building, then tap the map to place it.</p>
                    </div>
                    <div class="help-section">
                        <h4>🗺️ Exploration</h4>
                        <p>Long press on the map to send scouts to explore new areas.</p>
                    </div>
                    <div class="help-section">
                        <h4>📊 Management</h4>
                        <p>Check Stats tab to monitor your settlement's progress.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script type="importmap">
    {
        "imports": {
            "nipplejs": "https://esm.sh/nipplejs"
        }
    }
    </script>
    <script src="android.js"></script>
</body>
</html>